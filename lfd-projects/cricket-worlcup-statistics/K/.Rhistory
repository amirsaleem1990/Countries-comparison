bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
bowler <- bowler %>% filter(Opposition %in% countries)
bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
bowler <- bowler %>% arrange(desc(Start.Date))
bastman <- bastman %>% arrange(desc(Start.Date))
# select only last 15 matched for each player
bow_last_15 <- tbl_df(bowler) %>%
group_by(Player_ID) %>%
top_n(15)
bat_last_15 <- tbl_df(bastman) %>%
group_by(Player_ID) %>%
top_n(15)
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
bowler <- bowler %>% filter(Opposition %in% countries)
bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
bowler <- bowler %>% arrange(desc(Start.Date))
bastman <- bastman %>% arrange(desc(Start.Date))
# select only last 15 matched for each player
bowl_last_15 <- tbl_df(bowler) %>%
group_by(Player_ID) %>%
top_n(15)
bat_last_15 <- tbl_df(bastman) %>%
group_by(Player_ID) %>%
top_n(15)
bowl_last_15
table(bowl_last_15$Player_ID)
length(unique(bowler))
length(unique(bowler$Player_ID))
length(unique(bastman$Player_ID))
length(unique(bat_last_15$Player_ID))
length(unique(bat_last_15$Player_ID))
length(bat_last_15$Player_ID)
length(bastman$Player_ID)
rm(list = ls())
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
bowler <- bowler %>% filter(Opposition %in% countries)
bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
bowler <- bowler %>% arrange(desc(Start.Date))
bastman <- bastman %>% arrange(desc(Start.Date))
# select only last 15 matched for each player
bowl_last_15 <- tbl_df(bowler) %>%
group_by(Player_ID) %>%
top_n(15)
bat_last_15 <- tbl_df(bastman) %>%
group_by(Player_ID) %>%
top_n(15)
nrow(bowl_last_15)
nrow(bowler)
tbl_df(bowler) %>%
group_by(Player_ID) %>%
top_n(15)
# select only last 15 matched for each player
# bowl_last_15 <- tbl_df(bowler) %>%
#   group_by(Player_ID) %>%
#   top_n(15)
#
# bat_last_15 <- tbl_df(bastman) %>%
#   group_by(Player_ID) %>%
#   top_n(15)
tbl_df(bowler) %>%
group_by(Player_ID) %>%
tally(G) %>%
top_n(10)
bowler %>% arrange(SStart.Date) %>% group_by(Player_ID) %>% slice(c(1:3))
bowler %>% arrange(Start.Date) %>% group_by(Player_ID) %>% slice(c(1:3))
bowler %>% arrange(Start.Date) %>% group_by(Player_ID) %>% slice(c(1:15))
149*15
# select only last 15 matched for each player
bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:15))
# select only last 15 matched for each player
bowl_last_15 <- bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:15))
bat_last_15 <- bastman %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:15))
bat_last_15
unique(bowl_last_15$Opposition)
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
# bowler <- bowler %>% filter(Opposition %in% countries)
# bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
# select only last 15 matched for each player
bowl_last_20 <- bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bat_last_20 <- bastman %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bat_last_20
bowler <- data.table(read.csv("data/Bowler_data.csv"))
View(bowler)
bowl_last_20
glimpse(data)
glimpse(bowl_last_20)
gsub("-", NAN, bowl_last_20$Overs)
gsub("-", NaN, bowl_last_20$Overs)
gsub("-", "", bowl_last_20$Overs)
bowl_last_20$Overs gsub("-", "", bowl_last_20$Overs)
bowl_last_20$Overs <-  gsub("-", "", bowl_last_20$Overs)
glimpse(bowl_last_20)
lapply(bowl_last_20[c("Mdns", "Runs")], function(x) gsub("-", "", x))
bowl_last_20[, c("Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")] <- lapply(bowl_last_20[c("Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")], function(x) gsub("-", "", x))
glimpse(bowl_last_20)
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
# bowler <- bowler %>% filter(Opposition %in% countries)
# bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
# select only last 15 matched for each player
bowl_last_20 <- bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bat_last_20 <- bastman %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bowl_last_20$Overs <-  gsub("-", "", bowl_last_20$Overs)
bowl_last_20[, c("Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")] <- lapply(bowl_last_20[c("Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")], function(x) as.numeric(gsub("-", "", x)))
glimpse(bowl_last_20)
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
# bowler <- bowler %>% filter(Opposition %in% countries)
# bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
# select only last 15 matched for each player
bowl_last_20 <- bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bat_last_20 <- bastman %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bowl_last_20[, c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")] <-
lapply(bowl_last_20[c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")],
function(x) as.numeric(gsub("-", "", x)))
glimpse(bowl_last_20)
glimpse(bat_last_20)
names(bat_last_20)[1:6]
bat_last_20[, names(bat_last_20)[1:6]] <-
bat_last_20[, names(bat_last_20)[1:6]] <-
lapply(bat_last_20[, names(bat_last_20)[1:6]],
function(x) as.numeric(gsub("-", "", x)))
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
# bowler <- bowler %>% filter(Opposition %in% countries)
# bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
# select only last 15 matched for each player
bowl_last_20 <- bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bat_last_20 <- bastman %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bowl_last_20[, c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")] <-
lapply(bowl_last_20[c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")],
function(x) as.numeric(gsub("-", "", x)))
bat_last_20[, names(bat_last_20)[1:6]] <-
lapply(bat_last_20[, names(bat_last_20)[1:6]],
function(x) as.numeric(gsub("-", "", x)))
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
# bowler <- bowler %>% filter(Opposition %in% countries)
# bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
# select only last 15 matched for each player
bowl_last_20 <- bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bat_last_20 <- bastman %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bowl_last_20[, c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")] <-
lapply(bowl_last_20[c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")],
function(x) as.numeric(gsub("-", "", x)))
bat_last_20[, names(bat_last_20)[1:6]] <-
lapply(bat_last_20[, names(bat_last_20)[1:6]],
function(x) as.numeric(gsub("-", "", x)))
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
# bowler <- bowler %>% filter(Opposition %in% countries)
# bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
# select only last 15 matched for each player
bowl_last_20 <- bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bat_last_20 <- bastman %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bowl_last_20[, c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")] <-
lapply(bowl_last_20[c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")],
function(x) as.numeric(gsub("-", "", x)))
bat_last_20[, names(bat_last_20)[1:6]] <-
lapply(bat_last_20[, names(bat_last_20)[1:6]],
function(x) as.numeric(gsub("-", "", x)))
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
# bowler <- bowler %>% filter(Opposition %in% countries)
# bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
# select only last 15 matched for each player
bowl_last_20 <- bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bat_last_20 <- bastman %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bowl_last_20[, c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")] <-
lapply(bowl_last_20[c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")],
function(x) as.numeric(gsub("-", "", x)))
# bat_last_20[, names(bat_last_20)[1:6]] <-
#   lapply(bat_last_20[, names(bat_last_20)[1:6]],
#          function(x) as.numeric(gsub("-", "", x)))
glimpse(bowl_last_20)
# bat_last_20[, names(bat_last_20)[1:6]] <-
lapply(bat_last_20[, names(bat_last_20)[1:6]],
function(x) as.numeric(gsub("-", "", x)))
# bat_last_20[, names(bat_last_20)[1:6]] <-
lapply(bat_last_20[, names(bat_last_20)[1:6]],
function(x) as.numeric(x))
bat_last_20[, names(bat_last_20)[1:6]] <-
lapply(bat_last_20[, names(bat_last_20)[1:6]],
function(x) as.numeric(x))
glimpse(bat_last_20)
rm(list = ls())
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
# bowler <- bowler %>% filter(Opposition %in% countries)
# bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
# select only last 20 matches for each player
bowl_last_20 <- bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bat_last_20 <- bastman %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
# Conver Factors to Integers
bowl_last_20[, c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")] <-
lapply(bowl_last_20[c("Overs", "Mdns", "Runs", "Wkts", "Econ", "Ave", "SR")],
function(x) as.numeric(gsub("-", "", x)))
bat_last_20[, names(bat_last_20)[1:6]] <-
lapply(bat_last_20[, names(bat_last_20)[1:6]],
function(x) as.numeric(x))
names(bowl_last_20)
names(bowl_last_20)[1:7]
# Conver Factors to Integers
bowl_last_20[, names(bowl_last_20)[1:7]] <-
lapply(bowl_last_20[names(bowl_last_20)[1:7]],
function(x) as.numeric(gsub("-", "", x)))
bat_last_20[, names(bat_last_20)[1:6]] <-
lapply(bat_last_20[, names(bat_last_20)[1:6]],
function(x) as.numeric(x))
bowl_last_20
bat_last_20
sum(is.na(bowl_last_20))
dim(bowl_last_20)
9352/(2740*13)
df = read.csv("WC_2019_matches_winners_grounds_and_teams.csv")
df
unique(df$Stadium)
bat_last_20[1:10,]
unique(bat_last_20$Ground)
unique(bat_last_20$Ground) %in% unique(df$Stadium)
unique(df$Stadium) %in% unique(bat_last_20$Ground)
unique(bat_last_20$Ground) %in% unique(df$Stadium)
tolower(unique(bat_last_20$Ground)) %in% tolower(unique(df$Stadium))
sort(unique(df$Stadium))
sort(unique(bowl_last_20))
sort(unique(bowl_last_20$Ground))
split(unique(df$Stadium), ",")
sapply(strsplit(unique(df$Stadium),","), `[`, 1)
sapply(strsplit(unique(df$Stadium),"-"), `[`, 1)
sapply(strsplit(unique(df$Stadium),","), `,`, 1)
word <- c('apple-orange-strawberry','chocolate')
sapply(strsplit(word,"-"), `[`, 1)
sapply(strsplit(word,"-"), 1)
sapply(strsplit(word,"o"), `[`, 1)
sapply(strsplit(unique(df$Stadium),","), `[`, 1)
sapply(strsplit(unique(df$Stadium),"\,"), `[`, 1)
sapply(strsplit(unique(df$Stadium),", "), `[`, 1)
sapply(strsplit(unique(df$Stadium),"-"), `[`, 1)
unique(df$Stadium)
sapply(strsplit(unique(df$Stadium),"a"), `[`, 1)
sapply(strsplit(unique(df$Stadium),","), `[`, 1)
sapply(strsplit(word,","), `[`, 1)
sapply(strsplit(word,"-"), `[`, 1)
sapply(strsplit(as.vector(unique(df$Stadium)),"-"), `[`, 1)
sapply(strsplit(as.vector(unique(df$Stadium)),","), `[`, 1)
sapply(strsplit(as.vector(unique(df$Stadium)),","), `[`, 2)
trimws(sapply(strsplit(as.vector(unique(df$Stadium)),","), `[`, 2))
trimws(sapply(strsplit(as.vector(df$Stadium),","), `[`, 2))
df$Stadium <- trimws(sapply(strsplit(as.vector(df$Stadium),","), `[`, 2))
df$Stadium %in% bowl_last_20$Ground
sum(df$Stadium %in% bowl_last_20$Ground)
unique(df$Stadium)
sort(unique(df$Stadium))
sort(bowl_last_20$Ground)
sort(unique(df$Stadium))
sort(unique(bowl_last_20$Ground))
sum(df$Stadium %in% bowl_last_20$Ground)
sum(unique(df$Stadium) %in% unique(bowl_last_20$Ground))
sum(tolower(unique(df$Stadium)) %in% tolower(unique(bowl_last_20$Ground)))
sum(unique(df$Stadium) %in% unique(bowl_last_20$Ground))
unique(df$Stadium)
sum(unique(df$Stadium) %in% unique(bowl_last_20$Ground))
sum(unique(df$Stadium) %in% unique(bowl_last_20$Ground)) / length(unique(df$Stadium))
sort(unique(bowl_last_20$Ground))
library(data.table)
library(lubridate)
library(dplyr)
countries = c("India", "Bangladesh", "England", "Australia", "Pakistan", "South Africe",
"Afghanistan", "New Zealand", "West Indies", "Sri Lanka")
bowler <- data.table(read.csv("data/Bowler_data.csv"))
bastman <- data.table(read.csv("data/Batsman_Data.csv"))
bowler <- bowler %>% select(-X)
bastman <- bastman %>% select(-X)
bowler$Start.Date <- lubridate::dmy(bowler$Start.Date)
bastman$Start.Date <- lubridate::dmy(bastman$Start.Date)
bowler$Opposition <- gsub("^v ", "", bowler$Opposition)
bastman$Opposition <- gsub("^v ", "", bastman$Opposition)
# bowler <- bowler %>% filter(Opposition %in% countries)
# bastman <- bastman %>% filter(Opposition %in% countries)
bowler <- data.table(bowler)
bastman <- data.table(bastman)
# select only last 20 matches for each player
bowl_last_20 <- bowler %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
bat_last_20 <- bastman %>%
arrange(desc(Start.Date)) %>%
group_by(Player_ID) %>%
slice(c(1:20))
# Convert Factors to Integers
bowl_last_20[, names(bowl_last_20)[1:7]] <-
lapply(bowl_last_20[names(bowl_last_20)[1:7]],
function(x) as.numeric(gsub("-", "", x)))
bat_last_20[, names(bat_last_20)[1:6]] <-
lapply(bat_last_20[, names(bat_last_20)[1:6]],
function(x) as.numeric(x))
summarised_bow_last_20 <- bowl_last_20 %>%
group_by(Player_ID) %>%
summarise(Overs = sum(Overs, na.rm=T),
Mdns = sum(Mdns, na.rm=T),
Runs = sum(Runs, na.rm=T),
Wkts = sum(Wkts, na.rm=T),
Ave = sum(Ave, na.rm=T),
SR = sum(SR, na.rm=T))
summarised_bat_last_20 <- bat_last_20 %>%
group_by(Player_ID) %>%
summarise(Bat = sum(Bat1, na.rm = T),
Runs = sum(Runs, na.rm = T),
BF = sum(BF, na.rm = T),
SR = sum(SR, na.rm=T),
X4s = sum(X4s, na.rm=T),
X6s = sum(X6s, na.rm=T))
c <- cor(summarised_bat_last_20)
factors_data <- fa(r = c, nfactors = 6)
q()
